@page "{user_id}/{gallery_id:int}"
@using System.Security.Claims
@model exam_frontend.Pages.Gallery.Details

@* @{ *@
@*     ViewData["Title"] = "Gallery Images"; *@
@* } *@

<head>
    <link rel="stylesheet" href="~/css/gallery/details.css"/>
</head>

<div class="header-text">
    <h1>@Model.GalleryName</h1>
    <p>@(Model.Posts?.Count ?? 0) posts</p>   
</div>


<div class="gallery-container">
    @if (Model.Posts.Count > 0)
    {
        foreach (var image in Model.Posts)
        {
            <a asp-page="/Image/Details" asp-route-image_id="@image.Id" class="gallery-item-link">
                <div class="gallery-item">
                    @* <img src=@{await Model.api.GetWithContentAsync<string>($"/Minio/{image.Id})");} *@
                    @*      alt="Image"> *@
                </div>
            </a>
        }
    }
</div>

@if (@User.FindFirstValue(ClaimTypes.NameIdentifier) == Model.UserId)
{
<div class="gallery-actions">
    <a asp-page="/Image/Create" asp-route-gallery_id="@Model.GalleryId" class="btn-add">+ Add an Image</a>
    <a asp-page="/Gallery/Index" asp-route-user_id="@User.FindFirstValue(ClaimTypes.NameIdentifier)" class="btn-back">← Back to Galleries</a>
</div>
}
else
{
<a asp-page="/Index" class="btn-back">← Back to Feed</a>
}

@section Scripts {
<script>
    function confirmDelete(imageId) {
        if (confirm('Are you sure you want to delete this image? This action cannot be undone.')) {
            document.getElementById('deleteForm_' + imageId).submit();
        }
    }
</script>
}
